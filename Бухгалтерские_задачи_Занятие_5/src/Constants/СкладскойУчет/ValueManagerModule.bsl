Процедура ПриЗаписи(Отказ)

	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
				   |	СкладскойУчет.Значение КАК Значение
				   |ИЗ
				   |	Константа.СкладскойУчет КАК СкладскойУчет";

	РезультатЗапроса = Запрос.Выполнить();

	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();

	ВыборкаДетальныеЗаписи.Следующий();

	Если ВыборкаДетальныеЗаписи.Значение <> ДополнительныеСвойства.ЗначениеДо Тогда

		ОбновитьПовторноИспользуемыеЗначения();

		Если ВыборкаДетальныеЗаписи.Значение = Истина Тогда
			ВидСубконто = ПланыВидовХарактеристик.ВидыСубконто.Номенклатура;
		Иначе
			ВидСубконто = ПланыВидовХарактеристик.ВидыСубконто.Склады;
		КонецЕсли;

		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
					   |	СчетаВидыСубконто.Ссылка КАК Ссылка
					   |ИЗ
					   |	ПланСчетов.Счета.ВидыСубконто КАК СчетаВидыСубконто
					   |ГДЕ
					   |	СчетаВидыСубконто.ВидСубконто = &ВидСубконто";

		Запрос.УстановитьПараметр("ВидСубконто", ВидСубконто);

		РезультатЗапроса = Запрос.Выполнить();

		Выборка = РезультатЗапроса.Выбрать();

		Пока Выборка.Следующий() Цикл

			ДанныеСчета = НаСервереМожноВызватьСКлиента.ПолучитьСвойствоСчета(Выборка.Ссылка);

			ПСОбъект = Выборка.Ссылка.ПолучитьОбъект();
				//	ПСОбъект = ПланыСчетов.Счета.СоздатьСчет();
			Если ВыборкаДетальныеЗаписи.Значение = Истина Тогда
				//Добавить
				Если ДанныеСчета.КоличествоСубконто = 2 Тогда

					Продолжить;

				КонецЕсли;

				НоваяСтрока = ПСОбъект.ВидыСубконто.Добавить();
				НоваяСтрока.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконто.Склады;

			Иначе
				//Удалить
				СтрокаДляУдаления = ПСОбъект.ВидыСубконто.Найти(ПланыВидовХарактеристик.ВидыСубконто.Склады,
					"ВидСубконто");

				ПСОбъект.ВидыСубконто.Удалить(СтрокаДляУдаления);

			КонецЕсли;

			ПСОбъект.Записать();

		КонецЦикла;

	КонецЕсли;
КонецПроцедуры

Процедура ПередЗаписью(Отказ)

	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
				   |	СкладскойУчет.Значение КАК Значение
				   |ИЗ
				   |	Константа.СкладскойУчет КАК СкладскойУчет";

	РезультатЗапроса = Запрос.Выполнить();

	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();

	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл

		ДополнительныеСвойства.Вставить("ЗначениеДо", ВыборкаДетальныеЗаписи.Значение);

	КонецЦикла;

КонецПроцедуры